!function(root,ax_super){var U=ax5.util,axd=ax5.dom,ax_class=function(){this.main=function(){ax_super&&ax_super.call(this),this.config={click_event_name:"click",mask:{target:document.body,content:""},theme:"default",width:300,title:"",msg:""}}.apply(this,arguments),this.active_dialog=null,this.mask=new ax5.ui.mask;var cfg=this.config;this.init=function(){cfg.id="ax5-dialog-"+ax5.get_guid(),this.mask.set_config(cfg.mask)},this.alert=function(opts,callback){return U.is_string(opts)&&(opts={title:cfg.title,msg:opts}),opts.dialog_type="alert",opts.theme=opts.theme||cfg.theme||"","undefined"==typeof opts.btns&&(opts.btns={ok:{label:"ok",theme:opts.theme}}),this.open(opts,callback),this},this.confirm=function(opts,callback){return U.is_string(opts)&&(opts={title:cfg.title,msg:opts}),opts.dialog_type="confirm",opts.theme=opts.theme||cfg.theme||"","undefined"==typeof opts.btns&&(opts.btns={ok:{label:"ok",theme:opts.theme},cancel:{label:"cancel"}}),this.open(opts,callback),this},this.prompt=function(opts,callback){return U.is_string(opts)&&(opts={title:cfg.title,msg:opts}),opts.dialog_type="prompt",opts.theme=opts.theme||cfg.theme||"","undefined"==typeof opts.input&&(opts.input={value:{label:opts.msg||cfg.msg||""}}),"undefined"==typeof opts.btns&&(opts.btns={ok:{label:"ok",theme:opts.theme},cancel:{label:"cancel"}}),this.open(opts,callback),this},this.get_content=function(dialog_id,opts){var po=[];return po.push('<div id="'+dialog_id+'" data-ax5-ui="dialog" class="ax5-ui-dialog '+opts.theme+'">'),po.push('<div class="ax-dialog-heading">'),po.push(opts.title||cfg.title||""),po.push("</div>"),po.push('<div class="ax-dialog-body">'),po.push('<div class="ax-dialog-msg">'),opts.input?U.each(opts.input,function(k){po.push('<div class="ax-dialog-prompt">'),po.push(this.label.replace(/\n/g,"<br/>")),po.push("</div>"),po.push('<input type="text" class="ax-inp" data-ax-dialog-prompt="'+k+'" style="width:100%;" />')}):po.push((opts.msg||cfg.msg||"").replace(/\n/g,"<br/>")),po.push("</div>"),po.push('<div class="ax-dialog-buttons">'),po.push('<div class="ax-button-wrap">'),U.each(opts.btns,function(k){po.push('<button type="button" data-ax-dialog-btn="'+k+'" class="ax-btn '+this.theme+'">'+this.label+"</button>")}),po.push("</div>"),po.push("</div>"),po.push("</div>"),po.push("</div>"),po.join("")},this.open=function(opts,callback){var pos={},box={};opts.id=opts.id||cfg.id,this.mask.open(),box={width:opts.width||cfg.width},axd.append(document.body,this.get_content(opts.id,opts)),this.active_dialog=ax5.dom("#"+opts.id),this.active_dialog.css({width:box.width}),box.height=this.active_dialog.height(),"undefined"==typeof opts.position||"center"===opts.position?(pos.top=ax5.dom.height(document.body)/2-box.height/2,pos.left=ax5.dom.width(document.body)/2-box.width/2):(pos.left=opts.position.left||0,pos.top=opts.position.top||0),this.active_dialog.css(pos),"prompt"===opts.dialog_type?this.active_dialog.find("[data-ax-dialog-prompt]").elements[0].focus():this.active_dialog.find("[data-ax-dialog-btn]").elements[0].focus(),this.active_dialog.find("[data-ax-dialog-btn]").on(cfg.click_event_name,function(e){this.btn_onclick(e||window.event,opts,callback)}.bind(this)),axd(window).on("keydown.ax-dialog",function(e){this.onkeyup(e||window.event,opts,callback)}.bind(this))},this.btn_onclick=function(e,opts,callback,target,k){if(target=axd.parent(e.target,function(target){return ax5.dom.attr(target,"data-ax-dialog-btn")?!0:void 0})){k=axd.attr(target,"data-ax-dialog-btn");var that={key:k,value:opts.btns[k],dialog_id:opts.id,btn_target:target};if("prompt"===opts.dialog_type){var empty_key=null;for(var oi in opts.input)if(that[oi]=this.active_dialog.find("[data-ax-dialog-prompt="+oi+"]").val(),""==that[oi]||null==that[oi]){empty_key=oi;break}}if(opts.btns[k].onclick)opts.btns[k].onclick.call(that,k);else if("alert"===opts.dialog_type)callback&&callback.call(that,k),this.close();else if("confirm"===opts.dialog_type)callback&&callback.call(that,k),this.close();else if("prompt"===opts.dialog_type){if("ok"===k&&empty_key)return this.active_dialog.find('[data-ax-dialog-prompt="'+empty_key+'"]').elements[0].focus(),!1;callback&&callback.call(that,k),this.close()}}},this.onkeyup=function(e,opts,callback,target,k){if(e.keyCode==ax5.info.event_keys.ESC&&this.close(),"prompt"===opts.dialog_type&&e.keyCode==ax5.info.event_keys.RETURN){var that={key:k,value:opts.btns[k],dialog_id:opts.id,btn_target:target},empty_key=null;for(var oi in opts.input)if(that[oi]=this.active_dialog.find("[data-ax-dialog-prompt="+oi+"]").val(),""==that[oi]||null==that[oi]){empty_key=oi;break}if(empty_key)return!1;callback&&callback.call(that,k),this.close()}},this.close=function(){return this.active_dialog&&(this.active_dialog.remove(),this.mask.close(),this.active_dialog=null,axd(window).off("keydown.ax-dialog")),this}};U.is_function(ax_super)&&(ax_class.prototype=new ax_super),root.dialog=ax_class,"function"==typeof define&&define.amd&&define("_ax5_ui_dialog",[],function(){return ax_class})}(ax5.ui,ax5.ui.root),function(root,ax_super){var U=ax5.util,axd=ax5.dom,ax_class=function(){this.main=function(){ax_super&&ax_super.call(this),this.config={click_event_name:"ontouchstart"in document.documentElement?"touchstart":"click",theme:"default",keys:{label:"label",value:"value",width:"width",rowspan:"rowspan",colspan:"colspan",klass:"klass"}}}.apply(this,arguments);var cfg=this.config;this.init=function(){cfg.target&&cfg.board||U.error("aui_keypad_400","[ax5.ui.keypad] config.target, config.board is required"),cfg.target=ax5.dom(cfg.target),this.set_layout()},this.set_layout=function(){var cfg=this.config,keys=cfg.keys,po=[],col_width=cfg.board.col_width||"10px",col_height=cfg.board.col_height||"10px";po.push('<div class="ax5-ui-keypad '+cfg.theme+'">'),po.push('<table cellpadding="0" cellspacing="0">'),po.push("<tbody>"),po.push("<tr>");for(var item,i=0,ll=cfg.board.keys.length;ll>i;i++)item=cfg.board.keys[i],item.newline?po.push("</tr><tr>"):(po.push('<td rowspan="'+(item[keys.rowspan]||1)+'" colspan="'+(item[keys.colspan]||1)+'" style="'+function(css){return css=[],1==(item[keys.colspan]||1)&&css.push("width:"+(item[keys.width]?item[keys.width]:col_width)),css.join(";")}()+'">'),po.push('<div class="ax-btn-wraper" style="'+function(css){if(css=[],1==(item[keys.rowspan]||1))css.push("height:"+col_height);else{var unit=col_height.replace(/\d+/g,"")||"px";css.push("height:"+U.number(col_height)*item[keys.rowspan]+unit)}return css.join(";")}()+'">'),po.push('<button class="ax-btn '+(item[keys.klass]||"")+'" data-keypad-item-index="'+i+'">'+item[keys.label]+"</button>"),po.push("</div>"),po.push("</td>"));po.push("</tbody>"),po.push("</table>"),po.push("</div>"),cfg.target.html(po.join("")),cfg.target.find("[data-keypad-item-index]").on(cfg.click_event_name,function(e){this.onclick(e||window.event)}.bind(this))},this.onclick=function(e,target,index){target=axd.parent(e.target,function(target){return ax5.dom.attr(target,"data-keypad-item-index")?!0:void 0}),target&&(index=axd.attr(target,"data-keypad-item-index"),this.config.onclick&&this.config.onclick.call({keys:this.config.board.keys,item:this.config.board.keys[index],target:cfg.target.elements[0],item_target:target}))}};U.is_function(ax_super)&&(ax_class.prototype=new ax_super),root.keypad=ax_class,"function"==typeof define&&define.amd&&define("_ax5_ui_keypad",[],function(){return ax_class})}(ax5.ui,ax5.ui.root),function(root,ax_super){var U=ax5.util,axd=ax5.dom,ax_class=function(){var self=this;this.main=function(){ax_super&&ax_super.call(this),this.config={target:axd.get(document.body)[0]},this.mask_content="",this.status="off"}.apply(this,arguments),this.init=function(){this.config.content&&this.set_body(this.config.content)},this.set_body=function(content){this.mask_content=content},this.get_body=function(){return this.mask_content},this.open=function(config){"on"===this.status&&this.close(),config&&config.content&&this.set_body(config.content),self.mask_config={},U.extend(self.mask_config,this.config,!0),U.extend(self.mask_config,config,!0);var css,_mask,cfg=self.mask_config,target=axd.get(cfg.target)[0],po=[],mask_id="ax-mask-"+ax5.get_guid(),css={},that={};if(po.push('<div class="ax-mask" id="'+mask_id+'">'),po.push('<div class="ax-mask-bg"></div>'),po.push('<div class="ax-mask-content">'),po.push('<div class="ax-mask-body">'),po.push(self.get_body()),po.push("</div>"),po.push("</div>"),po.push("</div>"),target==document.body)axd.append(target,po.join(""));else{axd.append(document.body,po.join(""));var box_model=axd.box_model(target);css={position:"absolute",left:box_model.offset.left,top:box_model.offset.top,width:box_model.width,height:box_model.height},axd.class_name(target,"add","ax-masking")}return this._mask=_mask=axd.get("#"+mask_id),this.target=target,this.status="on",axd.css(_mask,css),cfg.onchange&&(that={type:"open"},cfg.onchange.call(that,that)),this},this.close=function(){var cfg=this.mask_config;return axd.remove(this._mask),axd.class_name(this.target,"remove","ax-masking"),cfg.onchange&&(that={type:"close"},cfg.onchange.call(that,that)),this}};U.is_function(ax_super)&&(ax_class.prototype=new ax_super),root.mask=ax_class,"function"==typeof define&&define.amd&&define("_ax5_ui_mask",[],function(){return ax_class})}(ax5.ui,ax5.ui.root),function(root,ax_super){var U=ax5.util,axd=ax5.dom,ax_class=function(){this.main=function(){ax_super&&ax_super.call(this),this.config={keys:{value:"value",text:"text",shortcut:"shortcut",data:"data",menu:"menu"}}}.apply(this,arguments);var cfg=this.config;this.init=function(){cfg.target&&cfg.menu||U.error("aui_menu_400","[ax5.ui.menu] config.target, config.menu is required"),cfg.target=ax5.dom(cfg.target),this.print_list()},this.print_list=function(){var cfg=this.config,po=[],get_child_menu_html=function(_po_,_menu_,_depth_){_po_.push('<ul class="ax-item-group ax-item-group-depth-'+_depth_+'">');for(var i=0,l=_menu_.length;l>i;i++)_po_.push('<a class="ax-item" data-menu-item-index="'+i+'">'),_po_.push(_menu_[i][cfg.keys.text]),_po_.push("</a>"),_menu_[i][cfg.keys.menu]&&_menu_[i][cfg.keys.menu].length>0&&get_child_menu_html(_po_,_menu_[i][cfg.keys.menu],_depth_+1);_po_.push("</ul>")};get_child_menu_html(po,cfg[cfg.keys.menu],0),cfg.target.html(po.join("")),cfg.target.find("[data-menu-item-index]").on("click",function(e){this.onclick(e||window.event)}.bind(this))},this.onclick=function(e,target,index){target=axd.parent(e.target,function(target){return ax5.dom.attr(target,"data-menu-item-index")?!0:void 0}),target&&(index=axd.attr(target,"data-menu-item-index"),this.config.onclick&&this.config.onclick.call({menu:this.config[cfg.keys.menu],item:this.config[cfg.keys.menu][index],target:cfg.target.elements[0],item_target:target}))}};U.is_function(ax_super)&&(ax_class.prototype=new ax_super),root.menu=ax_class,"function"==typeof define&&define.amd&&define("_ax5_ui_menu",[],function(){return ax_class})}(ax5.ui,ax5.ui.root),function(root,ax_super){var U=ax5.util,axd=ax5.dom,ax_class=function(){this.main=function(){ax_super&&ax_super.call(this),this.config={click_event_name:"click",theme:"default",width:300,axicon:'<i class="axi axi-axisj"></i>',msg:"",display_time:3e3,animate_time:200}}.apply(this,arguments),this.toast_container=null,this.queue=[];var cfg=this.config;this.init=function(){var container_id=ax5.get_guid();axd.append(document.body,'<div class="ax5-ui-toast-container" data-toast-container="'+container_id+'"></div>'),this.toast_container=ax5.dom('[data-toast-container="'+container_id+'"]')},this.push=function(opts,callback){return U.is_string(opts)&&(opts={title:cfg.title,msg:opts}),opts.toast_type="push",opts.theme=opts.theme||cfg.theme||"",this.open(opts,callback),this},this.confirm=function(opts,callback){return U.is_string(opts)&&(opts={title:cfg.title,msg:opts}),opts.toast_type="confirm",opts.theme=opts.theme||cfg.theme||"","undefined"==typeof opts.btns&&(opts.btns={ok:{label:"ok",theme:opts.theme}}),this.open(opts,callback),this},this.get_content=function(toast_id,opts){var po=[];return po.push('<div id="'+toast_id+'" data-ax5-ui="toast" class="ax5-ui-toast '+opts.theme+'">'),po.push('<div class="ax-toast-axicon">'),po.push(opts.axicon||cfg.axicon||""),po.push("</div>"),po.push('<div class="ax-toast-body">'),po.push((opts.msg||cfg.msg||"").replace(/\n/g,"<br/>")),po.push("</div>"),opts.btns&&(po.push('<div class="ax-toast-buttons">'),po.push('<div class="ax-button-wrap">'),U.each(opts.btns,function(k){po.push('<button type="button" data-ax-toast-btn="'+k+'" class="ax-btn '+this.theme+'">'+this.label+"</button>")}),po.push("</div>"),po.push("</div>")),po.push('<div style="clear:both;"></div>'),po.push("</div>"),po.join("")},this.open=function(opts,callback){var toast_box,box={};opts.id="ax5-toast-"+this.queue.length,this.queue.push(opts),box={width:opts.width||cfg.width},this.toast_container.prepend(this.get_content(opts.id,opts)),toast_box=ax5.dom("#"+opts.id),toast_box.css({width:box.width}),"push"===opts.toast_type?setTimeout(function(){this.close(opts,toast_box,callback)}.bind(this),cfg.display_time):"confirm"===opts.toast_type&&toast_box.find("[data-ax-toast-btn]").on(cfg.click_event_name,function(e){this.btn_onclick(e||window.event,opts,toast_box,callback)}.bind(this))},this.btn_onclick=function(e,opts,toast_box,callback,target,k){if(target=axd.parent(e.target,function(target){return ax5.dom.attr(target,"data-ax-toast-btn")?!0:void 0})){k=axd.attr(target,"data-ax-toast-btn");var that={key:k,value:opts.btns[k],toast_id:opts.id,btn_target:target};opts.btns[k].onclick?opts.btns[k].onclick.call(that,k):"confirm"===opts.toast_type&&(callback&&callback.call(that,k),this.close(opts,toast_box))}},this.onkeyup=function(e){e.keyCode==ax5.info.event_keys.ESC&&this.close()},this.close=function(opts,toast_box,callback){"undefined"==typeof toast_box&&(opts=U.last(this.queue),toast_box=ax5.dom("#"+opts.id));var that={toast_id:opts.id};return toast_box.class_name("add","push"==opts.toast_type?"removed":"destroy"),this.queue=U.filter(this.queue,function(){return opts.id!=this.id}),setTimeout(function(){toast_box.remove(),callback&&callback.call(that)},cfg.animate_time),this}};U.is_function(ax_super)&&(ax_class.prototype=new ax_super),root.toast=ax_class,"function"==typeof define&&define.amd&&define("_ax5_ui_toast",[],function(){return ax_class})}(ax5.ui,ax5.ui.root),function(root,ax_super){var U=ax5.util,axd=ax5.dom,ax_class=function(){this.main=function(){ax_super&&ax_super.call(this),this.config={click_event_name:"ontouchstart"in document.documentElement?"touchstart":"click",theme:"default",head_height:28,item_height:28,body:{}}}.apply(this,arguments),this.focused_index=-1,this.col_group=[],this.list=[];var cfg=this.config;this.init=function(){cfg.target||U.error("aui_touch_grid_400","[ax5.ui.touch_grid] config.target is required"),cfg.target=ax5.dom(cfg.target),this.col_group=this.convert_col_group(cfg.col_group),cfg.target.append(this.get_frame()),this.els={root:cfg.target.find('[data-touch-grid-els="root"]'),main:cfg.target.find('[data-touch-grid-els="main"]'),"main-header":cfg.target.find('[data-touch-grid-els="main-header"]'),"main-body":cfg.target.find('[data-touch-grid-els="main-body"]'),"main-body-content":cfg.target.find('[data-touch-grid-els="main-body-content"]')},this.set_size_frame(),this.els["main-header"].html(this.get_header())},this.get_frame=function(){var po=[];return po.push('<div class="ax5-ui-touch-grid '+cfg.theme+'" data-touch-grid-els="root">'),po.push('<div class="touch-grid-main" data-touch-grid-els="main">'),po.push('<div class="touch-grid-main-header" data-touch-grid-els="main-header">'),po.push("</div>"),po.push('<div class="touch-grid-main-body" data-touch-grid-els="main-body">'),po.push('<div class="touch-grid-content" data-touch-grid-els="main-body-content"></div>'),po.push("</div>"),po.push("</div>"),po.push("</div>"),po.join("")},this.set_size_frame=function(){var target_height=cfg.target.height();this.els.main.css({height:target_height}),this.els["main-header"].css({height:cfg.head_height}),this.els["main-body"].css({height:target_height-cfg.head_height})},this.convert_col_group=function(col_group){col_group=[].concat(col_group);for(var target_width=cfg.target.width(),free_width=target_width,free_width_col_count=0,i=0,l=col_group.length;l>i;i++)U.is_undefined(col_group[i].width)||"*"===col_group[i].width?free_width_col_count++:free_width-=U.number(col_group[i].width);if(free_width_col_count>0)for(var i=0,l=col_group.length;l>i;i++)(U.is_undefined(col_group[i].width)||"*"===col_group[i].width)&&(col_group[i].width=free_width/free_width_col_count);return col_group},this.get_col_group=function(){var po=[];po.push("<colgroup>");for(var i=0,l=this.col_group.length;l>i;i++)po.push('<col style="width:'+this.col_group[i].width+'px;" />');return po.push("</colgroup>"),po.join("")},this.get_header=function(){var po=[];po.push('<table style="height:'+cfg.head_height+'px;">'),po.push(this.get_col_group()),po.push("<tbody>"),po.push("<tr>");for(var i=0,l=this.col_group.length;l>i;i++)po.push("<td>"+this.col_group[i].label+"</td>");return po.push("</tr>"),po.push("</tbody>"),po.push("</table>"),po.join("")},this.get_list=function(){var po=[];if(this.list.length>0){po.push("<table>"),po.push(this.get_col_group()),po.push("<tbody>");for(var item,r=0,len=this.list.length;len>r;r++){item=this.list[r],po.push('<tr data-touch-grid-item-row="'+r+'" style="height:'+cfg.item_height+'px;">');for(var i=0,l=this.col_group.length;l>i;i++)po.push("<td>"+item[this.col_group[i].key]+"</td>");po.push("</tr>")}po.push("</tbody>"),po.push("</table>")}return po.join("")},this.set_list=function(list){this.list=list,this.focused_index=-1,this.els["main-body-content"].html(this.get_list()),this.els["main-body-content"].on("click",function(e){this.onclick(e||window.event)}.bind(this)),this.focus(0)},this.focus=function(index,by){this.focused_index>-1&&this.els["main-body-content"].find('[data-touch-grid-item-row="'+this.focused_index+'"]').class_name("remove","focus");var focused_item=this.els["main-body-content"].find('[data-touch-grid-item-row="'+index+'"]'),focused_item_height=focused_item.height(),focused_item_top=focused_item.position().top,body_content_top=this.els["main-body-content"].position().top,body_height=this.els["main-body"].height(),view_position_top=focused_item_top-U.number(body_content_top,{abs:!0});focused_item.class_name("add","focus"),this.focused_index=index,0>view_position_top?this.els["main-body-content"].css({top:-focused_item_top}):view_position_top+focused_item_height>body_height&&this.els["main-body-content"].css({top:body_height-view_position_top-focused_item_height})},this.onclick=function(e,target,index,that){target=axd.parent(e.target,function(target){return axd.attr(target,"data-touch-grid-item-row")?!0:void 0}),target&&(index=axd.attr(target,"data-touch-grid-item-row"),that={list:this.list,item:this.list[index],target:cfg.target.elements[0],item_target:target},this.focus(index),cfg.body.onclick&&cfg.body.onclick.call(that))}};U.is_function(ax_super)&&(ax_class.prototype=new ax_super),root.touch_grid=ax_class,"function"==typeof define&&define.amd&&define("_ax5_ui_touch_grid",[],function(){return ax_class})}(ax5.ui,ax5.ui.root);