!function(root,ax_super){var e_touch_start,e_touch_move,e_touch_end,U=ax5.util,axd=ax5.dom;"ontouchstart"in document.documentElement?(e_touch_start="touchstart",e_touch_move="touchmove",e_touch_end="touchend"):(e_touch_start="mousedown",e_touch_move="mousemove",e_touch_end="mouseup");var ax_class=function(){this.main=function(){ax_super&&ax_super.call(this),this.config={effect:"",autoSlide:!1,slideSpeed:300,touchMove:!1,targetHeightRatio:0}}.apply(this,arguments),this.target=null;var _this=this,cfg=this.config,touch_start={},touch_end={};this.display_index=0,this.get_mouse=function(e){var mouse={};return"changedTouches"in e?(mouse.x=Number(e.changedTouches[0].pageX),mouse.y=Number(e.changedTouches[0].pageY)):"touches"in e&&e.touches[0]?(mouse.x=Number(e.touches[0].pageX),mouse.y=Number(e.touches[0].pageY)):(mouse.x=Number(e.pageX),mouse.y=Number(e.pageY)),mouse},this.init=function(){if(this.target=ax5.dom(cfg.target),"ie"==ax5.info.browser.name&&Number(ax5.info.browser.version)<8)this.target.on("click",function(e){if(cfg.on_event){var that={display_index:0,action:"click"};cfg.on_event.call(that,that)}});else{if(this.els={holder:this.target.find(".slider-holder"),items:this.target.find(".slider-item"),dots:[]},this.els.items.elements.length>1&&0==this.els.dots.length){var po=[];po.push('<div class="slider-status">'),po.push('<div class="dot-group">');for(var i=0,l=this.els.items.elements.length;l>i;i++)po.push('<div class="dot" data-item-dot="'+i+'"></div>');po.push('<div class="on_dot" data-item-dot-on="on"></div>'),po.push("</div>"),po.push("</div>"),this.target.append(po.join(""));for(var i=0,l=this.target.find("[data-item-dot]").elements.length;l>i;i++)this.els.dots.push(axd(this.target.find("[data-item-dot]").elements[i]));this.els.dot_on=this.target.find("[data-item-dot-on]")}this.bind_window_resize(function(){this._set_size_frame()}),setTimeout(function(){_this._set_size_frame()},300),this.els.items.elements.length>1?this.target.on(e_touch_start,function(e){_this._on_touch_start(e||window.event)}):this.target.on("click",function(e){if(cfg.on_event){var that={display_index:0,action:"click"};cfg.on_event.call(that,that)}})}},this._set_size_frame=this.align=function(){var ct_width=this.target.width();ct_width>0&&(this.els.items.css({width:ct_width,"float":"left"}),this.els.holder.css({width:this.target.find(".slider-item").elements.length*ct_width}),this.els.items.elements.length>1&&(this.item_width=ct_width,this.holder_width=this.target.find(".slider-item").elements.length*ct_width,this.els.holder.css({left:-(this.item_width*this.display_index)}),this._update_dot()))},this._update_dot=function(){var bx=ax5.dom.box_model(this.els.dots[this.display_index]);this.els.dot_on.css({left:bx.position.left+bx.margin[3]})},this._on_touch_start=function(e){if(touch_start={mouse:_this.get_mouse(e),time:(new Date).getTime(),position:this.els.holder.position()},this.els.holder.class_name("remove","touch-end"),axd(document.body).on(e_touch_move+".ax5divslider",function(e){_this._on_touch_move(e||window.event)}),axd(document.body).on(e_touch_end+".ax5divslider",function(e){_this._on_touch_end(e||window.event)}),axd(document.body).on("mouseout.ax5divslider",function(e){_this._on_touch_end(e||window.event)}),axd(document.body).attr({onselectstart:"return false;"}),cfg.on_event){var that={display_index:this.display_index,action:"touch_start"};cfg.on_event.call(that,that)}},this._on_touch_move=function(e){var mouse=_this.get_mouse(e);if(!touch_start.direction){var dx=Math.abs(touch_start.mouse.x-mouse.x),dy=2*Math.abs(touch_start.mouse.y-mouse.y);touch_start.direction=dx>dy?"X":"Y"}if("X"==touch_start.direction){var new_left=Number(touch_start.position.left)-(touch_start.mouse.x-mouse.x);new_left>0?new_left=0:new_left<-(this.holder_width-this.item_width)&&(new_left=-(this.holder_width-this.item_width)),this.els.holder.css({left:new_left}),touch_start.time=(new Date).getTime(),touch_start.new_left=new_left,e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0}else axd(document.body).off(e_touch_move+".ax5divslider"),axd(document.body).off(e_touch_end+".ax5divslider"),axd(document.body).off("mouseout.ax5divslider"),axd(document.body).attr({onselectstart:null})},this._on_touch_end=function(e){touch_end={mouse:_this.get_mouse(e),time:(new Date).getTime()};var display_index,du_time=touch_end.time-touch_start.time,new_left=touch_start.new_left;if(120>du_time&&Math.abs(touch_start.mouse.x-touch_end.mouse.x)>5&&(touch_start.mouse.x-touch_end.mouse.x<0?this.display_index>0&&(new_left=-(this.item_width*(this.display_index-1))):this.display_index<this.els.items.elements.length-1&&(new_left=-(this.item_width*(this.display_index+1)))),"X"!=touch_start.direction&&cfg.on_event){var that={display_index:this.display_index,action:"click"};cfg.on_event.call(that,that),axd(document.body).off(e_touch_move+".ax5divslider"),axd(document.body).off(e_touch_end+".ax5divslider"),axd(document.body).off("mouseout.ax5divslider"),axd(document.body).attr({onselectstart:null}),e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0}if("undefined"!=typeof new_left){if(display_index=U.number(new_left/this.item_width,{round:!0,abs:!0}),this.els.holder.css({left:-(this.item_width*display_index)}).class_name("add","touch-end"),cfg.on_event)if(this.display_index!=display_index){var that={display_index:display_index,action:"status_change"};cfg.on_event.call(that,that)}else if(cfg.on_event){var that={display_index:this.display_index,action:"touch_end"};cfg.on_event.call(that,that)}this.display_index=display_index,this._update_dot(),axd(document.body).off(e_touch_move+".ax5divslider"),axd(document.body).off(e_touch_end+".ax5divslider"),axd(document.body).off("mouseout.ax5divslider"),axd(document.body).attr({onselectstart:null}),e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0}},this.prev=function(){if(this.display_index<=0)return this;if(this.display_index--,this.els.holder.css({left:-(this.item_width*this.display_index)}).class_name("add","touch-end"),this._update_dot(),cfg.on_event){var that={display_index:this.display_index,action:"status_change"};cfg.on_event.call(that,that)}},this.next=function(){if(this.display_index>=this.els.items.elements.length-1)return this;if(this.display_index++,this.els.holder.css({left:-(this.item_width*this.display_index)}).class_name("add","touch-end"),this._update_dot(),cfg.on_event){var that={display_index:this.display_index,action:"status_change"};cfg.on_event.call(that,that)}}};U.is_function(ax_super)&&(ax_class.prototype=new ax_super),root.div_slider=ax_class,"function"==typeof define&&define.amd&&define("_ax5_ui_div_slider",[],function(){return ax_class})}(ax5.ui,ax5.ui.root);