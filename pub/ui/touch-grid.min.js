!function(root,ax_super){var U=ax5.util,ax_class=(ax5.dom,function(){this.main=function(){ax_super&&ax_super.call(this),this.config={click_event_name:"ontouchstart"in document.documentElement?"touchstart":"click",theme:"default",head_height:28,item_height:28}}.apply(this,arguments),this.focused_index=-1,this.col_group=[],this.list=[];var cfg=this.config;this.init=function(){cfg.target||U.error("aui_touch_grid_400","[ax5.ui.touch_grid] config.target is required"),cfg.target=ax5.dom(cfg.target),this.col_group=this.convert_col_group(cfg.col_group),cfg.target.append(this.get_frame()),this.els={root:cfg.target.find('[data-touch-grid-els="root"]'),main:cfg.target.find('[data-touch-grid-els="main"]'),"main-header":cfg.target.find('[data-touch-grid-els="main-header"]'),"main-body":cfg.target.find('[data-touch-grid-els="main-body"]'),"main-body-content":cfg.target.find('[data-touch-grid-els="main-body-content"]')},this.set_size_frame(),this.els["main-header"].html(this.get_header())},this.get_frame=function(){var po=[];return po.push('<div class="ax5-ui-touch-grid '+cfg.theme+'" data-touch-grid-els="root">'),po.push('<div class="touch-grid-main" data-touch-grid-els="main">'),po.push('<div class="touch-grid-main-header" data-touch-grid-els="main-header">'),po.push("</div>"),po.push('<div class="touch-grid-main-body" data-touch-grid-els="main-body">'),po.push('<div class="touch-grid-content" data-touch-grid-els="main-body-content"></div>'),po.push("</div>"),po.push("</div>"),po.push("</div>"),po.join("")},this.set_size_frame=function(){var target_height=cfg.target.height();this.els.main.css({height:target_height}),this.els["main-header"].css({height:cfg.head_height}),this.els["main-body"].css({height:target_height-cfg.head_height})},this.convert_col_group=function(col_group){col_group=[].concat(col_group);for(var target_width=cfg.target.width(),free_width=target_width,free_width_col_count=0,i=0,l=col_group.length;l>i;i++)U.is_undefined(col_group[i].width)||"*"===col_group[i].width?free_width_col_count++:free_width-=U.number(col_group[i].width);if(free_width_col_count>0)for(var i=0,l=col_group.length;l>i;i++)(U.is_undefined(col_group[i].width)||"*"===col_group[i].width)&&(col_group[i].width=free_width/free_width_col_count);return col_group},this.get_col_group=function(){var po=[];po.push("<colgroup>");for(var i=0,l=this.col_group.length;l>i;i++)po.push('<col style="width:'+this.col_group[i].width+'px;" />');return po.push("</colgroup>"),po.join("")},this.get_header=function(){var po=[];po.push('<table style="height:'+cfg.head_height+'px;">'),po.push(this.get_col_group()),po.push("<tbody>"),po.push("<tr>");for(var i=0,l=this.col_group.length;l>i;i++)po.push("<td>"+this.col_group[i].label+"</td>");return po.push("</tr>"),po.push("</tbody>"),po.push("</table>"),po.join("")},this.get_list=function(){var po=[];if(this.list.length>0){po.push("<table>"),po.push(this.get_col_group()),po.push("<tbody>");for(var item,r=0,len=this.list.length;len>r;r++){item=this.list[r],po.push('<tr style="height:'+cfg.item_height+'px;">');for(var i=0,l=this.col_group.length;l>i;i++)po.push("<td>"+item[this.col_group[i].key]+"</td>");po.push("</tr>")}po.push("</tbody>"),po.push("</table>")}return po.join("")},this.set_list=function(list){this.list=list,this.els["main-body-content"].html(this.get_list())}});U.is_function(ax_super)&&(ax_class.prototype=new ax_super),root.touch_grid=ax_class,"function"==typeof define&&define.amd&&define("_ax5_ui_touch_grid",[],function(){return ax_class})}(ax5.ui,ax5.ui.root);